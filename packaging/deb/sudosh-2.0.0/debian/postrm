#!/bin/sh
set -e

if [ "$1" = "remove" ] || [ "$1" = "purge" ]; then
    # Check if sudo is actually sudosh and restore if needed
    if [ -f "/usr/bin/sudo" ] && [ -f "/usr/bin/sudo.orig" ]; then
        if /usr/bin/sudo --version 2>/dev/null | grep -q "sudosh"; then
            echo "Restoring original sudo..."
            cp /usr/bin/sudo.orig /usr/bin/sudo
            echo "Original sudo restored"
        fi
    fi
fi

# Clean up cache directory on removal
if [ "$1" = "purge" ]; then
    rm -rf /var/run/sudosh
    # Remove backup sudo on purge
    rm -f /usr/bin/sudo.orig
fi

#DEBHELPER#

exit 0
