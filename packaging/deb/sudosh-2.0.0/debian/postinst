#!/bin/sh
set -e

# Create cache directory
mkdir -p /var/run/sudosh
chmod 700 /var/run/sudosh
chown root:root /var/run/sudosh

# Check if this is a sudo replacement installation
if [ "$1" = "configure" ] && [ -n "$2" ]; then
    # This is an upgrade, check if we should maintain sudo replacement
    if [ -f "/usr/bin/sudo" ] && [ -f "/usr/bin/sudo.orig" ]; then
        # Check if current sudo is actually sudosh
        if /usr/bin/sudo --version 2>/dev/null | grep -q "sudosh"; then
            echo "Maintaining sudosh as sudo replacement"
        fi
    fi
elif [ "$1" = "configure" ]; then
    # Fresh installation
    echo "sudosh installed successfully"
    echo "To install sudosh as a sudo replacement, run:"
    echo "  sudo make install-sudo-replacement"
    echo ""
    echo "This will safely backup your original sudo to sudo.orig"
fi

#DEBHELPER#

exit 0
